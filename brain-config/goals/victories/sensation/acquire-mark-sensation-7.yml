name: Achieve the Seventh Mark of Sensation
requirements:
  elementId: ascensionsensationc
completedWhen:
  aspects: { desire: 7 }
impulses:
  - name: Work a junior job at Glover & Glover
    forbidders:
      # Stop working when we are waiting for the influence, as work takes longer than influence takes to expire
      allOf:
        - elementId: ascensionsensationf
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
        - elementId: fragmentgraild
    priority: maintenance
    operation: !import ../../../operations/glover/work-glover-junior.yml
  - name: Work at Glover & Glover under Alden
    forbidders:
      # Stop working when we are waiting for the influence, as work takes longer than influence takes to expire
      allOf:
        - elementId: ascensionsensationf
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
        - elementId: fragmentgraild
    priority: maintenance
    operation: !import ../../../operations/glover/work-glover-alden.yml
  - name: Work at Glover & Glover with diligence
    forbidders:
      # Stop working when we are waiting for the influence, as work takes longer than influence takes to expire
      allOf:
        - elementId: ascensionsensationf
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
        - elementId: fragmentgraild
    priority: maintenance
    operation: !import ../../../operations/glover/work-glover-diligence.yml
  - name: Work a senior job at Glover & Glover
    forbidders:
      # Stop working when we are waiting for the influence, as work takes longer than influence takes to expire
      allOf:
        - elementId: ascensionsensationf
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
        - elementId: fragmentgraild
    priority: maintenance
    operation: !import ../../../operations/glover/work-glover-senior.yml
  - name: Plead for job at Glover & Glover
    forbidders:
      # Stop working when we are waiting for the influence, as work takes longer than influence takes to expire
      allOf:
        - elementId: ascensionsensationf
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
        - elementId: fragmentgraild
    priority: maintenance
    operation: !import ../../../operations/glover/plead-glover.yml

  - name: Get a prisoner
    requirements:
      cardSet:
        # Wait until we are ready
        - elementId: fragmentgraild
        # Wait until our Cyprian is ready
        - aspects:
            romanticinterest: 1
            follower_honoured: 1
            exalted: 1
            grail:
              greaterThanOrEqualTo: 12
    forbidders:
      anyOf:
        - cardSet:
            - aspects: { prisoner: 1 }
            - aspects: { prisoner: 1 }
        - cardSet:
            - aspects: { desire: 7 }
            - aspects: { prisoner: 1 }
    operation:
      name: Get a prisoner
      situation: talk
      startingRecipe:
        slots:
          talk:
            aspects: { hq: 1 }
          Cellar:
            aspects:
              follower: 1
              romanticinterest:
                lessThan: 1
              exalted:
                lessThan: 1
              grail:
                lessThan: 5

  - name: Obtain Grail Influence from the Stag Door
    operation: !import ../../../operations/mansus/use-stag-ascent-of-knives.yml

  - name: Ascend
    priority: goal
    operation:
      name: Ascend
      situation: work
      startingRecipe:
        slots:
          work:
            elementId: ritefollowerconsumeinfluence
          Invocation:
            aspects: { lore: 1, grail: 8 }
          Assistant:
            aspects: { follower: 1, interested: 1, grail: 12 }
          Offering:
            aspects: { influence: 1, grail: 6 }
          Desire:
            elementId: ascensionsensationf
