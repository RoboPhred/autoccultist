name: Finish aquiring the Formula Fissive
# This is a continuation of ./victory-temptation-power-prepare-stag.yml
# Start with forged, lanternc, mothc
# mothc + lanternc = lanternd
# => forged, lanternd
# forged + lanternd = forgee
# => forgee
requirements:
  cardSet:
    - elementId: fragmentforged
    - elementId: fragmentlanternc
    - elementId: fragmentmothc
completedWhen:
  elementId: fragmentforgee
impulses:
  - name: Ensure we have glimmering
    priority: maintenance
    requirements:
      # Only need this for moth stuff
      anyOf:
        - elementId: fragmentmoth
        - elementId: fragmentmothb
        - elementId: fragmentmothc
    forbidders:
      anyOf:
        - elementId: glimmering
          # It takes 60 seconds for the operation to get to a point where it needs this.
          #  TODO: Should let the operation itself state this requirement.
          lifetimeRemaining:
            greaterThan: 60
    operation: !import ../../../operations/study-passion.yml

  # mothc + lanternc = lanternd
  - name: Subvert An Ecdysiast's Parable to Phanaean Invocation
    priority: goal
    operation: !import ../../../operations/lore/lantern/lore-subvert-moth-lantern-c.yml

  # forged + lanternd = forgee
  - name: Subvert the Phanaean Invocation to the Formula Fissive
    priority: goal
    operation: !import ../../../operations/lore/forge/lore-subvert-lantern-forge-d.yml
